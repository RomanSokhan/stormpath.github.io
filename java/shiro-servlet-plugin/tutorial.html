

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; Stormpath Shiro Servlet Plugin 0.7.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Stormpath Shiro Servlet Plugin 0.7.1 documentation" href="index.html"/>
        <link rel="next" title="Appendix" href="appendix.html"/>
        <link rel="prev" title="Custom Views" href="views.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Stormpath Shiro Servlet Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-apache-shiro">What is Apache Shiro?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-project">What is the Stormpath Shiro Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-project">Add the Stormpath Shiro Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-properties">Stormpath Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#sdk-client">SDK Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#advanced-apache-shiro-configuration">Advanced Apache Shiro Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#form-fields">Form Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#authentication-state">Authentication State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social.html#facebook-login">Facebook Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#google-login">Google Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#linkedin-login">LinkedIn Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#json-api">JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http-request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#token-authentication">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-sdk-client">Stormpath SDK Client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#authentication-authorization">Authentication &amp; Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#groups-are-roles">Groups are Roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html#permissions-as-custom-user-data">Permissions as Custom User Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#subscribe-to-events">Subscribe to Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="caching.html#caching-options">Caching Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#shared-cache">Shared Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#secure-the-application">Secure the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-roles">Using Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-permissions">Using Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wrapping-things-up">Wrapping Things Up</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Stormpath Shiro Servlet Plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/tutorial.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="tutorial">
<span id="id1"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will take you from zero to a Stormpath enabled application featuring the Stormpath Shiro Servlet Plugin .</p>
<p>It should take about 30 minutes from start to finish. If you are looking for a bare bones intro to using Stormpath and
Apache Shiro, check out the <a class="reference internal" href="quickstart.html"><em>Quickstart</em></a>.</p>
<p>If you&#8217;ve already gone through the quickstart, jump over to the <a class="reference internal" href="#secure-the-app"><span>Secure the Application</span></a> section.</p>
<p>All of the code in the tutorial makes use of the <code class="docutils literal"><span class="pre">stormpath-shiro-servlet-plugin</span></code>. This integrates Stormpath and Apache Shiro with minimal configuration.
This tutorial will start with an existing JAX-RS application, without any security, and walk through the steps required to
integrate Stormpath and Apache Shiro.</p>
<p>Topics:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#get-an-api-key" id="id5">Get an API Key</a></li>
<li><a class="reference internal" href="#secure-the-application" id="id6">Secure the Application</a><ul>
<li><a class="reference internal" href="#our-application" id="id7">Our Application</a></li>
<li><a class="reference internal" href="#add-authentication" id="id8">Add Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-roles" id="id9">Using Roles</a><ul>
<li><a class="reference internal" href="#create-groups" id="id10">Create Groups</a></li>
<li><a class="reference internal" href="#assign-groups-to-users" id="id11">Assign Groups to Users</a></li>
<li><a class="reference internal" href="#groups-are-roles" id="id12">Groups are Roles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-permissions" id="id13">Using Permissions</a></li>
<li><a class="reference internal" href="#wrapping-things-up" id="id14">Wrapping Things Up</a></li>
</ul>
</div>
<div class="section" id="get-an-api-key">
<h2><a class="toc-backref" href="#id5">Get an API Key</a><a class="headerlink" href="#get-an-api-key" title="Permalink to this headline">¶</a></h2>
<p>All communication with Stormpath must be authenticated with an API Key.</p>
<ol class="arabic">
<li><p class="first">If you haven’t already, <a class="reference external" href="https://api.stormpath.com/register">sign up for Stormpath for free</a>.  You’ll be sent a verification email.</p>
</li>
<li><p class="first">Click the link in the verification email.</p>
</li>
<li><p class="first">Log in to the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> using the email address and password you used during registration and the assigned tenant id.</p>
</li>
<li><p class="first">Click the <strong>Create API</strong> Key or <strong>Manage Existing Keys</strong> button.</p>
</li>
<li><p class="first">Under <strong>Security Credentials</strong>, click <strong>Create API Key</strong>.</p>
<p>This will generate your API Key and download it to your computer as an <code class="docutils literal"><span class="pre">apiKey.properties</span></code> file.</p>
</li>
<li><p class="first">Save the file in your home directory in the following location:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">~/.stormpath/apiKey.properties</span></code> on Unix, Linux and Mac OS</li>
<li><code class="docutils literal"><span class="pre">C:\Users\YOUR_USERNAME\.stormpath\apiKey.properties</span></code> on Windows</li>
</ul>
</li>
<li><p class="first">Change the file permissions to ensure only you can read this file and not accidentally write or modify it. For example:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>$ chmod go-rwx ~/.stormpath/apiKey.properties
$ chmod u-w ~/.stormpath/apiKey.properties
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>On Windows, you can <a class="reference external" href="http://msdn.microsoft.com/en-us/library/bb727008.aspx">set file permissions similarly</a>.</p>
</div>
<div class="section" id="secure-the-application">
<span id="secure-the-app"></span><h2><a class="toc-backref" href="#id6">Secure the Application</a><a class="headerlink" href="#secure-the-application" title="Permalink to this headline">¶</a></h2>
<p>For the rest of the tutorial, we will be referring to the tutorial code found <a class="reference external" href="https://github.com/stormpath/stormpath-shiro/tree/master/tutorials/servlet">here</a>.</p>
<p>Each of the tutorial sections is completely standalone and can be run by executing a single Apache Maven command <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">jetty:run</span></code> and then browsing to <a class="reference external" href="http://localhost:8080">http://localhost:8080</a></p>
<div class="section" id="our-application">
<h3><a class="toc-backref" href="#id7">Our Application</a><a class="headerlink" href="#our-application" title="Permalink to this headline">¶</a></h3>
<p>The example application is a simple JAX-RS application with a <code class="docutils literal"><span class="pre">trooper</span></code> resource for basic CRUD operations.</p>
<p>Grab the code from <a class="reference external" href="https://github.com/stormpath/stormpath-shiro/tree/master/tutorials/servlet/00-initial-app">here</a>, and start the application using <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">jetty:run</span></code>.</p>
<p>You can open a browser to <a class="reference external" href="http://localhost:8080/trooper">http://localhost:8080/trooper</a> and a json object containing fifty random Stormtroopers will be
returned.  Once you verify you have everything working, you can kill the process using <code class="docutils literal"><span class="pre">^C</span></code>.</p>
</div>
<div class="section" id="add-authentication">
<h3><a class="toc-backref" href="#id8">Add Authentication</a><a class="headerlink" href="#add-authentication" title="Permalink to this headline">¶</a></h3>
<p>Adding authentication to this application is as easy as adding a dependency and then telling Apache Shiro which paths you
want to protect.</p>
<p>The dependency in our pom.xml looks like this:</p>
<pre class="literal-block">
&lt;dependency&gt;
    &lt;groupId&gt;com.stormpath.spring&lt;/groupId&gt;
    &lt;artifactId&gt;stormpath-default-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;0.7.1&lt;/version&gt;
&lt;/dependency&gt;
</pre>
<p>Our basic <code class="docutils literal"><span class="pre">shiro.ini</span></code> from <code class="docutils literal"><span class="pre">src/main/resources/</span></code> is as follows:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span> <span class="k">[main]</span>
 <span class="c1"># Shiro and the Stormpath API can use the same configured Cache Manager (optional)</span>
 <span class="na">cacheManager</span> <span class="o">=</span> <span class="s">org.apache.shiro.cache.MemoryConstrainedCacheManager</span>
<span class="s"> securityManager.cacheManager = $cacheManager</span>
<span class="s"> stormpathClient.cacheManager = $cacheManager</span>

 <span class="c1"># we can disable session tracking completely, and have Stormpath manage it for us (optional)</span>
 <span class="na">sessionManager</span> <span class="o">=</span> <span class="s">org.apache.shiro.web.session.mgt.DefaultWebSessionManager</span>
<span class="s"> securityManager.sessionManager = $sessionManager</span>
<span class="s"> securityManager.sessionManager.sessionIdCookieEnabled = false</span>
<span class="s"> securityManager.sessionManager.sessionIdUrlRewritingEnabled = false</span>

<span class="hll"> <span class="k">[urls]</span>
</span><span class="hll"> <span class="c1"># Ant-style path matching</span>
</span><span class="hll"> <span class="na">/**</span> <span class="o">=</span> <span class="s">authc</span>
</span>
 <span class="k">[stormpath]</span>
 <span class="c1"># you can set your application href here, a System Property with the same name &#39;stormpath.application.href &#39;,</span>
 <span class="c1"># or via an environment variable &#39;STORMPATH_APPLICATION_HREF&#39;, this is required if you have more then one application</span>
 <span class="c1"># in your Stormpath tenant.</span>
 <span class="c1"># stormpath.application.href = https://api.stormpath.com/v1/applications/&lt;APPLICATION_ID&gt;</span>
</pre></div>
</div>
<p>The highlighted lines above tell Apache Shiro to protect all paths, in other words, every resource in our application requires authentication.</p>
<p>Start up the application, again by using <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">jetty:run</span></code>, and navigate to <a class="reference external" href="http://localhost:8080/trooper">http://localhost:8080/trooper</a> where you will
be redirected to the login page.  At this point you can login with an existing user or register a new user, once logged in,
navigate to <a class="reference external" href="http://localhost:8080/trooper">http://localhost:8080/trooper</a> .</p>
<p>The need to retype the URL can be fixed by adding setting the <code class="docutils literal"><span class="pre">stormpath.web.login.nextUri</span></code> property.  In the <code class="docutils literal"><span class="pre">[stormpath]</span></code> section of the <code class="docutils literal"><span class="pre">shiro.ini</span></code>, add the following line:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span> [stormpath]
 ...
<span class="hll"> stormpath.web.login.nextUri = /trooper
</span></pre></div>
</div>
<p>Restart the application, this time after logging in you will be automatically redirected to <code class="docutils literal"><span class="pre">/trooper</span></code>.</p>
</div>
</div>
<div class="section" id="using-roles">
<h2><a class="toc-backref" href="#id9">Using Roles</a><a class="headerlink" href="#using-roles" title="Permalink to this headline">¶</a></h2>
<p>At this point your code should look like <a class="reference external" href="https://github.com/stormpath/stormpath-shiro/tree/master/tutorials/servlet/01-add-security">this</a>. Simply adding authentication to the application is a
great first step, but typically it is not enough, as different users need different types of access.  The following sections will discuss authorization options.</p>
<p>In this section you will create Stormpath groups, assign those groups to users, and finally use the groups as Shiro roles.</p>
<div class="section" id="create-groups">
<h3><a class="toc-backref" href="#id10">Create Groups</a><a class="headerlink" href="#create-groups" title="Permalink to this headline">¶</a></h3>
<p>Log in to the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> and click on the &#8216;Groups&#8217; tab.  Next click the &#8216;Create Group&#8217; button.</p>
<p>Select the directory associated with your application (typically &#8216;My Application Directory&#8217; unless you have changed this).</p>
<p>Enter &#8216;underling&#8217; for the name and &#8216;Underling&#8217; for the description and press the &#8216;Create&#8217; button.  Repeat this process two more times
for the &#8216;officer&#8217; and &#8216;emperor&#8217; groups.</p>
<img alt="_images/create-group.png" src="_images/create-group.png" />
<p>These three groups <code class="docutils literal"><span class="pre">underling</span></code>, <code class="docutils literal"><span class="pre">officer</span></code>, and <code class="docutils literal"><span class="pre">emperor</span></code> in our tutorial will represent a basic user, power-user, and administrator.</p>
<p>You can read more about groups in the <a class="reference external" href="http://docs.stormpath.com/console/product-guide/#create-a-group">Stormpath Product Guide</a> .</p>
</div>
<div class="section" id="assign-groups-to-users">
<h3><a class="toc-backref" href="#id11">Assign Groups to Users</a><a class="headerlink" href="#assign-groups-to-users" title="Permalink to this headline">¶</a></h3>
<p>Using the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a>, create three users, one for each role.  You can assign groups to users as you create them.</p>
<img alt="_images/create-account.png" src="_images/create-account.png" />
</div>
<div class="section" id="groups-are-roles">
<h3><a class="toc-backref" href="#id12">Groups are Roles</a><a class="headerlink" href="#groups-are-roles" title="Permalink to this headline">¶</a></h3>
<p>By default Stormpath groups are mapped to Shiro roles using the group&#8217;s HREF.  We recommend using using the <code class="docutils literal"><span class="pre">HREF</span></code> or <code class="docutils literal"><span class="pre">ID</span></code>
of the role as those are immutable, unlike the group&#8217;s name. In this example however, we will use the group&#8217;s name which will
make following along the tutorial easier.  You can read more about group configuration in the <a class="reference internal" href="access-control.html#access-control"><span>Access Control</span></a> documentation.</p>
<p>Change the group mode to <code class="docutils literal"><span class="pre">NAME</span></code> and update thepath mappings in our <code class="docutils literal"><span class="pre">shiro.ini</span></code>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span> [main]
 ...
<span class="hll"> stormpathRealm.groupRoleResolver.modeNames = NAME
</span>
<span class="hll"> [urls]
</span><span class="hll"> /trooper = authc
</span><span class="hll"> /trooper/** = authc,roles[officer]
</span></pre></div>
</div>
<p>Restart your application and browse to <a class="reference external" href="http://localhost:8080/trooper">http://localhost:8080/trooper</a> and all logged in users will be able to see the list
of stormtroopers, but only users with the <code class="docutils literal"><span class="pre">officer</span></code> role can view or edit a specific trooper via <code class="docutils literal"><span class="pre">/trooper/&lt;id&gt;</span></code></p>
</div>
</div>
<div class="section" id="using-permissions">
<h2><a class="toc-backref" href="#id13">Using Permissions</a><a class="headerlink" href="#using-permissions" title="Permalink to this headline">¶</a></h2>
<p>Roles are great for some use-case, but for others they fall short. If you require fine grained access control over your resources
then permissions are the way to go.  Apache Shiro uses <a class="reference external" href="http://shiro.apache.org/permissions.html">wild card permissions</a>, which will provide
a great deal of flexibility.</p>
<p>Permission strings can be stored in custom data associated with groups or accounts. By default the Stormpath Shiro Servlet Plugin looks for a custom data entry named <code class="docutils literal"><span class="pre">apacheShiroPermissions</span></code></p>
<p>Back in the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> click on the &#8216;Groups&#8217; tab again and edit each of the groups you created above.</p>
<img alt="_images/group-custom-data.png" src="_images/group-custom-data.png" />
<p>Each group&#8217;s custom data so each group matches the table below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Group</th>
<th class="head">Custom Data</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>underling</td>
<td><div class="first last highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;apacheShiroPermissions&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;tutorial:trooper:read&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
<td>Underlings will only be allowed to read.</td>
</tr>
<tr class="row-odd"><td>officer</td>
<td><div class="first last highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;apacheShiroPermissions&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;tutorial:trooper:create,read&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Officers will be able to create and read.</div>
<div class="line">This is equivalent to granting both</div>
<div class="line"><code class="docutils literal"><span class="pre">tutorial:trooper:create</span></code> and</div>
<div class="line"><code class="docutils literal"><span class="pre">tutorial:trooper:read</span></code> permissions.</div>
</div>
</td>
</tr>
<tr class="row-even"><td>emperor</td>
<td><div class="first last highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;apacheShiroPermissions&quot;</span><span class="o">:</span> <span class="p">[</span>
     <span class="s2">&quot;*&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
<td>The emperor can do what ever he wants.</td>
</tr>
</tbody>
</table>
<p>Finally, update the <code class="docutils literal"><span class="pre">[urls]</span></code> section of your <code class="docutils literal"><span class="pre">shiro.ini</span></code> to use these permissions.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span> <span class="k">[urls]</span>
<span class="hll"> <span class="na">/trooper</span> <span class="o">=</span> <span class="s">authc,rest[tutorial:trooper]</span>
</span><span class="hll"><span class="s"> /trooper/** = authc,rest[tutorial:trooper]</span>
</span></pre></div>
</div>
<p>The special <code class="docutils literal"><span class="pre">rest</span></code> permission will append the equivalent CRUD operation to the corresponding request method.  For this
simple application we are only worried about GET (read) and POST (create). So users with <code class="docutils literal"><span class="pre">tutorial:trooper:read</span></code> will be
able to view the list of stormtroopers, and view the <code class="docutils literal"><span class="pre">/troopers/&lt;id&gt;</span></code> resource.  And users with <code class="docutils literal"><span class="pre">tutorial:trooper:create</span></code>
will be able to create new stormtroopers.</p>
</div>
<div class="section" id="wrapping-things-up">
<h2><a class="toc-backref" href="#id14">Wrapping Things Up</a><a class="headerlink" href="#wrapping-things-up" title="Permalink to this headline">¶</a></h2>
<p>At this point we have gone through creating users and groups, mapping groups to roles, and storing permissions custom data. If you have been following along your application should look like <a class="reference external" href="https://github.com/stormpath/stormpath-shiro/tree/master/tutorials/servlet/03-use-permissions">this</a> .</p>
<p>We have focused almost entirely on configuration inside of the <code class="docutils literal"><span class="pre">shiro.ini</span></code> file, adding entries to the <code class="docutils literal"><span class="pre">[stormpath]</span></code> section to configure how the Stormpath API functions, and the <code class="docutils literal"><span class="pre">[urls]</span></code> section to map our resources to roles or permissions.</p>
<p>Instead of defining your access requirements in your <code class="docutils literal"><span class="pre">shiro.ini</span></code> file, you can use <a class="reference external" href="http://shiro.apache.org/authorization.html#Authorization-AnnotationbasedAuthorization">annotations</a> or directly
<a class="reference external" href="http://shiro.apache.org/authorization.html#Authorization-ProgrammaticAuthorization">in your code</a> .  Furthermore, if you need access to the Stormpath API, you <a class="reference internal" href="request.html#request"><span>can do that too</span></a> .</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="appendix.html" class="btn btn-neutral float-right" title="Appendix">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="views.html" class="btn btn-neutral" title="Custom Views"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src=".//cdn.optimizely.com/js/225847041.js"></script>
  <script type="text/javascript" >
    $(document).ready(function() {
      $("a[href^='http']").attr('target','_blank');
    });
  </script>


</body>
</html>