

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration &mdash; Stormpath Shiro Servlet Plugin 0.7.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Stormpath Shiro Servlet Plugin 0.7.1 documentation" href="index.html"/>
        <link rel="next" title="Registration" href="registration.html"/>
        <link rel="prev" title="Quickstart" href="quickstart.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Stormpath Shiro Servlet Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-apache-shiro">What is Apache Shiro?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-project">What is the Stormpath Shiro Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-project">Add the Stormpath Shiro Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stormpath-properties">Stormpath Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sdk-client">SDK Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-apache-shiro-configuration">Advanced Apache Shiro Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#form-fields">Form Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#authentication-state">Authentication State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social.html#facebook-login">Facebook Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#google-login">Google Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#linkedin-login">LinkedIn Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="social.html#json-api">JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http-request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#token-authentication">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-sdk-client">Stormpath SDK Client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#authentication-authorization">Authentication &amp; Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#groups-are-roles">Groups are Roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html#permissions-as-custom-user-data">Permissions as Custom User Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#subscribe-to-events">Subscribe to Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="caching.html#caching-options">Caching Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#shared-cache">Shared Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#secure-the-application">Secure the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#using-roles">Using Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#using-permissions">Using Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#wrapping-things-up">Wrapping Things Up</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Stormpath Shiro Servlet Plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Configuration</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/config.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="configuration">
<span id="config"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#no-config" id="id4">No Config?</a></li>
<li><a class="reference internal" href="#web-xml" id="id5">web.xml</a></li>
<li><a class="reference internal" href="#stormpath-properties" id="id6">Stormpath Properties</a><ul>
<li><a class="reference internal" href="#property-locations" id="id7">Property Locations</a></li>
<li><a class="reference internal" href="#security-considerations-passwords-and-secret-values" id="id8">Security Considerations: Passwords and secret values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sdk-client" id="id9">SDK Client</a><ul>
<li><a class="reference internal" href="#api-key" id="id10">API Key</a></li>
<li><a class="reference internal" href="#http-proxy" id="id11">HTTP Proxy</a></li>
<li><a class="reference internal" href="#authentication-scheme" id="id12">Authentication Scheme</a></li>
<li><a class="reference internal" href="#usage" id="id13">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stormpath-application" id="id14">Stormpath Application</a><ul>
<li><a class="reference internal" href="#id2" id="id15">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#filters" id="id16">Filters</a></li>
<li><a class="reference internal" href="#advanced-apache-shiro-configuration" id="id17">Advanced Apache Shiro Configuration</a></li>
</ul>
</div>
<div class="section" id="no-config">
<h2><a class="toc-backref" href="#id4">No Config?</a><a class="headerlink" href="#no-config" title="Permalink to this headline">¶</a></h2>
<p>Refreshingly, the Stormpath Shiro Servlet Plugin doesn&#8217;t require any configuration at all as long as the following conditions
apply:</p>
<ol class="arabic simple">
<li>You added the stormpath-shiro-servlet-plugin .jar and its transitive dependencies to your web application&#8217;s <code class="docutils literal"><span class="pre">/WEB-INF/lib</span></code> directory.  This happens automatically if you use a Maven-compatible build tool like Maven or Gradle to <a class="reference internal" href="quickstart.html#servlet-plugin-jar"><span>specify the stormpath-servlet-plugin dependency</span></a> in your project build configuration.</li>
<li>Your web application can read the <code class="docutils literal"><span class="pre">$HOME/.stormpath/apiKey.properties</span></code> file <a class="reference internal" href="quickstart.html#get-api-key"><span>mentioned in the Quickstart</span></a>.</li>
<li>You have only one Application registered with Stormpath.</li>
</ol>
<p>If all of these conditions cannot be met, then you will have to specify some minimal configuration (but not much!) as
described below.</p>
</div>
<div class="section" id="web-xml">
<h2><a class="toc-backref" href="#id5">web.xml</a><a class="headerlink" href="#web-xml" title="Permalink to this headline">¶</a></h2>
<p>Most plugin users do not need to modify the web application <code class="docutils literal"><span class="pre">/WEB-INF/web.xml</span></code> file to enable the plugin - just adding the plugin .jar to your web application&#8217;s <code class="docutils literal"><span class="pre">lib</span></code> directory is usually sufficient.</p>
<p>However, some applications might experience a filter chain conflict that causes problems.</p>
<p>At application startup, the Stormpath Shiro Servlet Plugin automatically enables a <code class="docutils literal"><span class="pre">ShiroFilter</span></code> (which in turn configures a <code class="docutils literal"><span class="pre">StormpathFilter</span></code>) to handle various request flows.  If your web application uses frameworks that make heavy use of servlet filters, like Spring MVC, these existing filters might cause an ordering conflict with the <code class="docutils literal"><span class="pre">ShiroFilter</span></code>.</p>
<p>If you are experiencing problems after adding the stormpath-shiro-servlet-plugin .jar to your web app&#8217;s classpath, you&#8217;ll need to explicitly specify where the <code class="docutils literal"><span class="pre">ShiroFilter</span></code> should reside in your application&#8217;s filter chain.  Luckily the fix is really easy:</p>
<p>Simply specify the following XML chunk in <code class="docutils literal"><span class="pre">/WEB-INF/web.xml</span></code> relative to other filter mappings that are already enabled in your application:</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;filter-mapping&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>ShiroFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>It is often easiest to specifying this at or near the top of your other filter mappings.  The <code class="docutils literal"><span class="pre">ShiroFilter</span></code> will ignore all filtered requests that do not match recognized URL rules, allowing other frameworks to filter requests as necessary.</p>
</div>
<div class="section" id="stormpath-properties">
<h2><a class="toc-backref" href="#id6">Stormpath Properties</a><a class="headerlink" href="#stormpath-properties" title="Permalink to this headline">¶</a></h2>
<p>If you need to customize behavior, the Stormpath Shiro Servlet Plugin uses a very simple <code class="docutils literal"><span class="pre">.properties</span></code> based configuration format and supports a convenient override mechanism using various property definition locations.</p>
<p>All stormpath configuration properties are prefixed with <code class="docutils literal"><span class="pre">stormpath.</span></code> and take the following form (for example)</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.some.property.name</span> <span class="o">=</span> <span class="s">aValue</span>
<span class="na">stormpath.another.property.name</span> <span class="o">=</span> <span class="s">anotherValue</span>
</pre></div>
</div>
<p>etc.</p>
<div class="section" id="property-locations">
<span id="stormpath-properties-locations"></span><h3><a class="toc-backref" href="#id7">Property Locations</a><a class="headerlink" href="#property-locations" title="Permalink to this headline">¶</a></h3>
<p>You can define stormpath property values in a number of locations.  This allows you to define a core set of properties in a primary configuration file and override values as necessary using other locations.</p>
<p>Configuration property values are read from the following locations, <em>in order</em>.  Values discovered in locations later (further down in the list) will automatically override values found in previous locations:</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><a class="reference internal" href="#plugin-web-stormpath-properties" id="id18">1. Plugin web.stormpath.properties</a></li>
<li><a class="reference internal" href="#classpath-stormpath-properties" id="id19">2. classpath:stormpath.properties</a></li>
<li><a class="reference internal" href="#web-inf-stormpath-properties" id="id20">3. /WEB-INF/stormpath.properties</a></li>
<li><a class="reference internal" href="#servlet-context-parameters" id="id21">4. Servlet Context Parameters</a></li>
<li><a class="reference internal" href="#environment-variables" id="id22">5. Environment Variables</a></li>
<li><a class="reference internal" href="#jvm-system-properties" id="id23">6. JVM System Properties</a></li>
<li><a class="reference internal" href="#shiro-ini" id="id24">7. shiro.ini</a></li>
</ul>
</div>
<p>If you&#8217;re just starting out, we recommend that your configuration be specified in <code class="docutils literal"><span class="pre">/WEB-INF/stormpath.properties</span></code> and you use Environment Variables to specify password or secret values (e.g. for production environments).</p>
<p>Defining properties in these locations is covered more in detail next.</p>
<div class="section" id="plugin-web-stormpath-properties">
<h4><a class="toc-backref" href="#id18">1. Plugin web.stormpath.properties</a><a class="headerlink" href="#plugin-web-stormpath-properties" title="Permalink to this headline">¶</a></h4>
<p>This file resides in the stormpath-servlet-plugin-0.7.1.jar at:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">/com/stormpath/sdk/servlet/config/web.stormpath.properties</span></code></div></blockquote>
<p>It includes all of the plugin&#8217;s default configuration and is not modifiable.  The default values within can be overridden by specifying properties in locations read later during the startup process.</p>
</div>
<div class="section" id="classpath-stormpath-properties">
<h4><a class="toc-backref" href="#id19">2. classpath:stormpath.properties</a><a class="headerlink" href="#classpath-stormpath-properties" title="Permalink to this headline">¶</a></h4>
<p>If a <code class="docutils literal"><span class="pre">stormpath.properties</span></code> file exists at the root of your web application&#8217;s classpath (typically in <code class="docutils literal"><span class="pre">/WEB-INF/classes</span></code> or at the root of one of your .jar files in <code class="docutils literal"><span class="pre">/WEB-INF/lib</span></code>), <code class="docutils literal"><span class="pre">stormpath.*</span></code> properties will be read from that file and override any identically-named properties discovered previously.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because this is not a web-specific location, it is only recommended to use this location if you wish to share stormpath properties configuration across multiple projects in a &#8216;resource .jar&#8217; that is used in such projects.</p>
</div>
</div>
<div class="section" id="web-inf-stormpath-properties">
<h4><a class="toc-backref" href="#id20">3. /WEB-INF/stormpath.properties</a><a class="headerlink" href="#web-inf-stormpath-properties" title="Permalink to this headline">¶</a></h4>
<p>If a file <code class="docutils literal"><span class="pre">/WEB-INF/stormpath.properties</span></code> exists in your web application, properties will be read from this file and override any identically-named properties discovered in previous locations.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">This is the recommended primary configuration location for most web applications.</p>
</div>
</div>
<div class="section" id="servlet-context-parameters">
<h4><a class="toc-backref" href="#id21">4. Servlet Context Parameters</a><a class="headerlink" href="#servlet-context-parameters" title="Permalink to this headline">¶</a></h4>
<p>If you define <code class="docutils literal"><span class="pre">stormpath.*</span></code> servlet context parameters in your web application&#8217;s <code class="docutils literal"><span class="pre">/WEB-INF/web.xml</span></code> file, they will override any identically-named properties discovered in previous locations.  For example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;context-param&gt;</span>
    <span class="nt">&lt;param-name&gt;</span>stormpath.foo.bar<span class="nt">&lt;/param-name&gt;</span>
    <span class="nt">&lt;param-value&gt;</span>myValue<span class="nt">&lt;/param-value&gt;</span>
<span class="nt">&lt;/context-param&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="environment-variables">
<h4><a class="toc-backref" href="#id22">5. Environment Variables</a><a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h4>
<p>You may use Environment Variables to specify or override your application&#8217;s <code class="docutils literal"><span class="pre">stormpath.*</span></code> properties using an all uppercase + underscore convention.</p>
<p>For example, let&#8217;s assume there is a property named <code class="docutils literal"><span class="pre">stormpath.foo.bar</span></code> that you would might specify in a file:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.foo.bar</span> <span class="o">=</span> <span class="s">myValue</span>
</pre></div>
</div>
<p>If you wanted to specify this property as an environment variable, you would change all characters to uppercase and replace all period characters <code class="docutils literal"><span class="pre">.</span></code> with underscores <code class="docutils literal"><span class="pre">_</span></code>. The above example then becomes:</p>
<p><code class="docutils literal"><span class="pre">STORMPATH_FOO_BAR=myValue</span></code></p>
<p>For example, using the bash shell on a *nix operating system:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">STORMPATH_FOO_BAR</span><span class="o">=</span>myValue
</pre></div>
</div>
</div>
<div class="section" id="jvm-system-properties">
<h4><a class="toc-backref" href="#id23">6. JVM System Properties</a><a class="headerlink" href="#jvm-system-properties" title="Permalink to this headline">¶</a></h4>
<p>If you define <code class="docutils literal"><span class="pre">stormpath.*</span></code> system properties (using <code class="docutils literal"><span class="pre">-D</span></code> flags when starting the java process), they will override any identically-named properties discovered in previous locations.  For example:</p>
<p><code class="docutils literal"><span class="pre">-Dstormpath.foo.bar=myValue</span></code></p>
</div>
<div class="section" id="shiro-ini">
<h4><a class="toc-backref" href="#id24">7. shiro.ini</a><a class="headerlink" href="#shiro-ini" title="Permalink to this headline">¶</a></h4>
<p>Your Apache Shiro application likely already contains a <code class="docutils literal"><span class="pre">shiro.ini</span></code> file.  Any Stormpath property can be set in the <code class="docutils literal"><span class="pre">[stormpath]</span></code> section of this file, for example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[stormpath]</span>
<span class="na">stormpath.foo.bar</span> <span class="o">=</span> <span class="s">trooper</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="security-considerations-passwords-and-secret-values">
<span id="stormpath-properties-security-considerations"></span><h3><a class="toc-backref" href="#id8">Security Considerations: Passwords and secret values</a><a class="headerlink" href="#security-considerations-passwords-and-secret-values" title="Permalink to this headline">¶</a></h3>
<p>It is <strong>strongly</strong> recommended that you do not specify the <code class="docutils literal"><span class="pre">stormpath.client.apiKey.secret</span></code> property - or any other password or secret property - in shared files such as <code class="docutils literal"><span class="pre">classpath:stormpath.properties</span></code>, <code class="docutils literal"><span class="pre">/WEB-INF/stormpath.properties</span></code>, or <code class="docutils literal"><span class="pre">web.xml</span></code>. These files are usually committed to version control (like git) and shared with other developers.</p>
<p>Because Stormpath API Keys are always assigned to an individual person, they should never be shared with or visible to anyone else, not even other co-workers or even Stormpath employees.  Anyone that has your API Key id and secret can alter the data in your Stormpath tenant.</p>
<p>Also, it should also be noted that, while JVM System Properties are not usually visible to other developers, using System Properties for secrets and passwords can also be seen as a security risk: system property values are visible to anyone performing a process listing on a production machine (e.g. <code class="docutils literal"><span class="pre">ps</span> <span class="pre">aux</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">java</span></code>).</p>
<p>If you cannot rely on accessing the default <code class="docutils literal"><span class="pre">$HOME/.stormpath/apiKey.properties</span></code> file, Environment Variables or a different private local file (with restricted read permissions) is usually a safer alternative when defining passwords or secret values than shared files or JVM System Properties.</p>
</div>
</div>
<div class="section" id="sdk-client">
<h2><a class="toc-backref" href="#id9">SDK Client</a><a class="headerlink" href="#sdk-client" title="Permalink to this headline">¶</a></h2>
<p>The Stormpath Shiro Servlet Plugin depends on a Stormpath SDK <code class="docutils literal"><span class="pre">Client</span></code> instance to communicate with Stormpath for most functionality.  You may configure the client via <code class="docutils literal"><span class="pre">stormpath.*</span></code> properties as necessary.</p>
<div class="section" id="api-key">
<h3><a class="toc-backref" href="#id10">API Key</a><a class="headerlink" href="#api-key" title="Permalink to this headline">¶</a></h3>
<p>The API Key used by the SDK Client will be acquired from the following locations.  Locations inspected later override previously discovered values.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">$HOME/.stormpath/apiKey.properties</span></code> file</li>
<li>Any <code class="docutils literal"><span class="pre">stormpath.client.apiKey.id</span></code> value discovered from inspected <a class="reference internal" href="#stormpath-properties-locations"><span>property locations</span></a></li>
<li>Any <code class="docutils literal"><span class="pre">stormpath.client.apiKey.secret</span></code> value discovered from inspected <a class="reference internal" href="#stormpath-properties-locations"><span>property locations</span></a> <strong>*</strong></li>
</ul>
<p><strong>*</strong> While <code class="docutils literal"><span class="pre">stormpath.client.apiKey.secret</span></code> can be configured as a property in a file, please be aware of the <a class="reference internal" href="#stormpath-properties-locations"><span>security considerations</span></a> of files shared with other people.</p>
</div>
<div class="section" id="http-proxy">
<h3><a class="toc-backref" href="#id11">HTTP Proxy</a><a class="headerlink" href="#http-proxy" title="Permalink to this headline">¶</a></h3>
<p>If your application requires communication to Stormpath go through an HTTP Proxy, you can set the following configuration properties as needed:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">stormpath.client.proxy.host</span></code>: Proxy server hostname or IP address, e.g. <code class="docutils literal"><span class="pre">proxy.mycompany.com</span></code> or <code class="docutils literal"><span class="pre">10.0.2.88</span></code>.</li>
<li><code class="docutils literal"><span class="pre">stormpath.client.proxy.port</span></code>: Proxy server port, for example <code class="docutils literal"><span class="pre">8888</span></code>.</li>
<li><code class="docutils literal"><span class="pre">stormpath.client.proxy.username</span></code>: Username to use when connecting to the proxy server.  Only configure this property if proxy server username/password authentication is required.</li>
<li><code class="docutils literal"><span class="pre">stormpath.client.proxy.password</span></code>: Password to use when connecting to the proxy server.  Only configure this property if proxy server username/password authentication is required, but <strong>note</strong>: it is strongly recommended that you don&#8217;t embed passwords in text files. You might want to specify this property as an environment variable, for example:</li>
</ul>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">STORMPATH_PROXY_PASSWORD</span><span class="o">=</span>your_proxy_server_password
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="authentication-scheme">
<h3><a class="toc-backref" href="#id12">Authentication Scheme</a><a class="headerlink" href="#authentication-scheme" title="Permalink to this headline">¶</a></h3>
<p>The Stormpath SDK Client communicates with Stormpath using a very secure <a class="reference external" href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic digest</a>-based authentication scheme.</p>
<p>If you deploy your app on Google App Engine however, you might experience some problems.  You can change the scheme to use <code class="docutils literal"><span class="pre">basic</span></code> authentication by setting the following configuration property and value:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.client.authenticationScheme</span> <span class="o">=</span> <span class="s">basic</span>
</pre></div>
</div>
<p>If your application is not deployed on Google App Engine, we recommend that you <em>do not</em> set this property.</p>
</div>
<div class="section" id="usage">
<h3><a class="toc-backref" href="#id13">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>After application startup, you may access the <code class="docutils literal"><span class="pre">Client</span></code> instance if desired using the <code class="docutils literal"><span class="pre">ClientResolver</span></code> and referencing the web application&#8217;s <code class="docutils literal"><span class="pre">ServletContext</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.stormpath.sdk.servlet.client.ClientResolver</span><span class="o">;</span>
<span class="c1">//...</span>

<span class="n">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="n">ClientResolver</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">getClient</span><span class="o">(</span><span class="n">servletContext</span><span class="o">);</span>
</pre></div>
</div>
<p>You can also <a class="reference internal" href="request.html#request-sdk-client"><span>access the client via a ServletRequest</span></a>.</p>
</div>
</div>
<div class="section" id="stormpath-application">
<h2><a class="toc-backref" href="#id14">Stormpath Application</a><a class="headerlink" href="#stormpath-application" title="Permalink to this headline">¶</a></h2>
<p>The Stormpath Shiro Servlet Plugin requires that your web application correspond to a registered <code class="docutils literal"><span class="pre">Application</span></code> record within Stormpath.</p>
<p>If you only have one registered application with Stormpath, the plugin will automatically query Stormpath at startup, find the <code class="docutils literal"><span class="pre">Application</span></code> and use it, and no configuration is necessary.</p>
<p>However, if you have more than one application registered with Stormpath, you must configure the <code class="docutils literal"><span class="pre">href</span></code> of the specific application to access by setting the following configuration property:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.application.href</span> <span class="o">=</span> <span class="s">your_application_href_here</span>
</pre></div>
</div>
<p>You can find your application&#8217;s href in the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a>:</p>
<ol class="arabic">
<li><p class="first">Click on the <code class="docutils literal"><span class="pre">Applications</span></code> tab and find your application in the list.  Click on the Application&#8217;s name:</p>
<img alt="_images/console-applications-ann.png" src="_images/console-applications-ann.png" />
</li>
<li><p class="first">On the resulting <em>Application Details</em> page, the <strong>REST URL</strong> property value is your application&#8217;s <code class="docutils literal"><span class="pre">href</span></code>:</p>
<img alt="_images/console-application-href.png" src="_images/console-application-href.png" />
</li>
</ol>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id15">Usage</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>After application startup, you may access the <code class="docutils literal"><span class="pre">Application</span></code> instance if desired (for example, searching your application&#8217;s user accounts, creating groups, etc) using the <code class="docutils literal"><span class="pre">ApplicationResolver</span></code> and referencing the web application&#8217;s <code class="docutils literal"><span class="pre">ServletContext</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.stormpath.sdk.servlet.application.ApplicationResolver</span><span class="o">;</span>
<span class="c1">//...</span>

<span class="n">Application</span> <span class="n">myApp</span> <span class="o">=</span> <span class="n">ApplicationResolver</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">getApplication</span><span class="o">(</span><span class="n">servletContext</span><span class="o">);</span>
</pre></div>
</div>
<p>You can also <a class="reference internal" href="request.html#request-application"><span>access the application via a ServletRequest</span></a>.</p>
</div>
</div>
<div class="section" id="filters">
<span id="id3"></span><h2><a class="toc-backref" href="#id16">Filters</a><a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h2>
<p>Both Apache Shiro and Stormpath&#8217;s APIs work largely by intercepting requests to certain URI paths in your application and then executing one or more servlet filters based on the URI being accessed.
The Stormpath Shiro Servlet Plugin uses <a class="reference external" href="https://docs.stormpath.com/java/servlet-plugin/config.html#filters">Stormpath&#8217;s Filters</a> to manage user login and registration workflows, however while both Stormpath filters and Apache Shiro&#8217;s filters can be used, it is recommended to use <a class="reference external" href="https://shiro.apache.org/web.html">Apache Shiro&#8217;s Filter</a> configurations
when defining your protected paths, in order to your configuration easier to manage.</p>
</div>
<div class="section" id="advanced-apache-shiro-configuration">
<h2><a class="toc-backref" href="#id17">Advanced Apache Shiro Configuration</a><a class="headerlink" href="#advanced-apache-shiro-configuration" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above the Stormpath Shiro Servlet Plugin will automatically configure both Apache Shiro and Stormpath Filters.  It does this by extending Shiro&#8217;s <code class="docutils literal"><span class="pre">IniWebEnvironment</span></code> in <a class="reference external" href="https://github.com/stormpath/stormpath-shiro/blob/dev/extensions/servlet/src/main/java/com/stormpath/shiro/servlet/env/StormpathShiroIniEnvironment.java">StormpathShiroIniEnvironment</a>, which automaticly configures a
Shiro realm (<code class="docutils literal"><span class="pre">com.stormpath.shiro.realm.PassthroughApplicationRealm</span></code>).  This behavior or implementations can be overwritten as expected in your <code class="docutils literal"><span class="pre">shiro.ini</span></code> file, for example to change the Stormpath realm implementation
your config might look something like this:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[main]</span>
<span class="na">stormpathRealm</span> <span class="o">=</span> <span class="s">biz.mycorp.shiro.realm.MyCustomizedStormpathRealm</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="registration.html" class="btn btn-neutral float-right" title="Registration">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="Quickstart"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src=".//cdn.optimizely.com/js/225847041.js"></script>
  <script type="text/javascript" >
    $(document).ready(function() {
      $("a[href^='http']").attr('target','_blank');
    });
  </script>


</body>
</html>