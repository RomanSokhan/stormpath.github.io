

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Login &mdash; Stormpath Java Servlet Plugin 1.5.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Stormpath Java Servlet Plugin 1.5.4 documentation" href="index.html"/>
        <link rel="next" title="Social Login" href="social.html"/>
        <link rel="prev" title="Registration" href="registration.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  
  <script src="https://cdn.optimizely.com/js/225847041.js"></script>

  
  <script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '986262161469311');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=986262161469311&ev=PageView&noscript=1"
  /></noscript>
</head>

<body class="wy-body-for-nav" role="document">

  
  <noscript><iframe src=".//www.googletagmanager.com/ns.html?id=GTM-NQZZFW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NQZZFW');</script>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Stormpath Java Servlet Plugin
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-project">What is the Stormpath Java Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-project">Add the Stormpath Java Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#any-problems">Any Problems?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-properties">stormpath.properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#property-locations">Property Locations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="config.html#plugin-web-stormpath-properties">1. Plugin web.stormpath.properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#classpath-stormpath-properties">2. classpath:stormpath.properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#web-inf-stormpath-properties">3. /WEB-INF/stormpath.properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#servlet-context-parameters">4. Servlet Context Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#environment-variables">5. Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="config.html#jvm-system-properties">6. JVM System Properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="config.html#security-considerations-passwords-and-secret-values">Security Considerations: Passwords and secret values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-client">Stormpath Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#api-key">API Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#http-proxy">HTTP Proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#authentication-scheme">Authentication Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-application">Stormpath Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#id2">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html#filters">Filters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#default-filters">Default Filters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html#uris">URIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#uri-evaluation-priority">URI Evaluation Priority</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#enabled">Enabled</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#next-uri">Next URI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="registration.html#next-query-parameter">Next Query Parameter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#autologin">AutoLogin</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#form-fields">Form Fields</a><ul>
<li class="toctree-l4"><a class="reference internal" href="registration.html#form-field-definitions">Form Field Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="registration.html#standard-form-fields">Standard Form Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="registration.html#custom-form-fields">Custom Form Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="registration.html#optional-form-fields">Optional Form Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="registration.html#disabling-form-fields">Disabling Form Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="registration.html#form-field-order">Form Field Order</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#password-strength">Password Strength</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#try-it">Try it!</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#verify-link-base-url">Verify Link Base URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#verify-next-uri">Verify Next URI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#pre-register-handler">Pre Register Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#post-register-handler">Post Register Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#registered-account">Registered Account</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#verified-account">Verified Account</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uri">URI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#next-query-parameter">Next Query Parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-login-handler">Pre Login Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#post-login-handler">Post Login Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication-state">Authentication State</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#saving-authentication-state">Saving Authentication State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cookie-storage">Cookie Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cookie-config">Cookie Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jwt-creation">JWT Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disabling-cookie-storage">Disabling Cookie Storage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#custom-savers">Custom Savers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social.html">Social Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social.html#facebook-login">Facebook Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-facebook-app">Create a Facebook App</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#specify-allowed-urls">Specify Allowed URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-facebook-directory">Create a Facebook Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#test-it-out">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social.html#google-login">Google Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-google-project">Create a Google Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#enable-google-login">Enable Google Login</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-oauth-credentials">Create OAuth Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-google-directory">Create a Google Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#id1">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social.html#linkedin-login">LinkedIn Login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-linkedin-application">Create a LinkedIn Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#enable-linkedin-permissions">Enable LinkedIn Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#create-a-linkedin-directory">Create a LinkedIn Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social.html#id2">Test it Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social.html#json-api">JSON API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="logout.html#next-query-parameter">Next Query Parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="request-authentication.html#token-authentication">Token Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request-authentication.html#get-a-token">Get a Token</a><ul>
<li class="toctree-l4"><a class="reference internal" href="request-authentication.html#curl">cURL</a></li>
<li class="toctree-l4"><a class="reference internal" href="request-authentication.html#html-form-and-ajax">HTML Form and AJAX</a></li>
<li class="toctree-l4"><a class="reference internal" href="request-authentication.html#origin-or-referer-required">Origin or Referer Required</a></li>
<li class="toctree-l4"><a class="reference internal" href="request-authentication.html#https-required">HTTPS Required</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="request-authentication.html#api-key-authentication">API Key Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request-authentication.html#determining-api-key-authentication">Determining API Key Authentication</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request.html#account-resolver">Account Resolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="request.html#request-attributes">Request Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="request.html#request-attribute-names">Request Attribute Names</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="request.html#http-servlet-request-api">HTTP Servlet Request API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="request.html#httpservletrequest-getremoteuser">HttpServletRequest getRemoteUser()</a></li>
<li class="toctree-l4"><a class="reference internal" href="request.html#httpservletrequest-getuserprincipal">HttpServletRequest getUserPrincipal()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request.html#application-resolver">Application Resolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="request.html#id2">Request Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="request.html#default-request-attribute-name">Default Request Attribute Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="request.html#custom-request-attribute-names">Custom Request Attribute Names</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-client">Stormpath Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request.html#client-resolver">Client Resolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="request.html#id3">Request Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="request.html#id4">Default Request Attribute Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="request.html#id5">Custom Request Attribute Names</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="access-control.html">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="access-control.html#unauthenticatedhandler">UnauthenticatedHandler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="access-control.html#exclusions">Exclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#requesteventlistener">RequestEventListener</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="caching.html#in-process-cache">In-Process Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#disable-caching">Disable Caching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="caching.html#default-ttl">Default TTL</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#default-tti">Default TTI</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#cache-regions">Cache Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching.html#client-cache-regions">Client Cache Regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#shared-cache">Shared Cache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="caching.html#nonce-cache-region">Nonce Cache Region</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="idsite.html">ID Site</a><ul>
<li class="toctree-l2"><a class="reference internal" href="idsite.html#how-does-it-work">How Does It Work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="idsite.html#enable-id-site">Enable ID Site</a></li>
<li class="toctree-l2"><a class="reference internal" href="idsite.html#configure-your-application">Configure Your Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="idsite.html#try-it">Try It!</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix/web-stormpath-properties.html">web.stormpath.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/i18n-properties.html">i18n.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/stormpath-css.html">stormpath.css</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/change-password.html">/WEB-INF/jsp/stormpath/change-password.jsp</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/forgot-password.html">/WEB-INF/jsp/stormpath/forgot-password.jsp</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/login.html">/WEB-INF/jsp/stormpath/login.jsp</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/register.html">/WEB-INF/jsp/stormpath/register.jsp</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/verify.html">/WEB-INF/jsp/stormpath/verify.jsp</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stormpath Java Servlet Plugin</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 







<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Login</li>
    <li class="wy-breadcrumbs-aside">
      
          
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <blockquote>
<div></div></blockquote>
<div class="section" id="login">
<span id="id1"></span><h1>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id11">Overview</a></li>
<li><a class="reference internal" href="#security-notice" id="id12">Security Notice</a></li>
<li><a class="reference internal" href="#uri" id="id13">URI</a><ul>
<li><a class="reference internal" href="#next-query-parameter" id="id14">Next Query Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#next-uri" id="id15">Next URI</a></li>
<li><a class="reference internal" href="#internationalization-i18n" id="id16">Internationalization (i18n)</a></li>
<li><a class="reference internal" href="#pre-login-handler" id="id17">Pre Login Handler</a></li>
<li><a class="reference internal" href="#post-login-handler" id="id18">Post Login Handler</a></li>
<li><a class="reference internal" href="#events" id="id19">Events</a></li>
<li><a class="reference internal" href="#authentication-state" id="id20">Authentication State</a><ul>
<li><a class="reference internal" href="#saving-authentication-state" id="id21">Saving Authentication State</a></li>
<li><a class="reference internal" href="#cookie-storage" id="id22">Cookie Storage</a></li>
<li><a class="reference internal" href="#custom-savers" id="id23">Custom Savers</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id11">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="registration.html#registration"><span class="std std-ref">Registered</span></a> users may login by visiting <code class="docutils literal"><span class="pre">/login</span></code>:</p>
<img alt="_images/login.png" src="_images/login.png" />
<p>After entering a valid account username or email address and password, the user will be logged in and redirected back to your application&#8217;s <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServletRequest.html#getContextPath()">context path</a> (&#8216;home page&#8217;) by default.</p>
<p>The default login view also has links to allow the user to <a class="reference internal" href="registration.html#registration"><span class="std std-ref">register a new user account</span></a> or <a class="reference internal" href="forgot-password.html#forgot-password"><span class="std std-ref">reset their password</span></a> if they forgot it.</p>
</div>
<div class="section" id="security-notice">
<span id="https-required"></span><h2><a class="toc-backref" href="#id12">Security Notice</a><a class="headerlink" href="#security-notice" title="Permalink to this headline">¶</a></h2>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p>HTTPS Required</p>
<p><strong>HTTPS must be enabled during a login attempt and for all future requests UNTIL THE USER LOGS OUT</strong>.</p>
<p>This is the only way to protect your users and prevent password attacks and man-in-the-middle or session hijacking attacks.  Even in internal company (intranet) environments this is required to ensure security.</p>
<p class="last">Using HTTPS only during login attempts and then returning to HTTP afterwards is an easily exploitable and very serious security hole.  Please do not do this.</p>
</div>
<p>The Stormpath Java Servlet Plugin will not enforce HTTPS so that you may easily test during development. It is expected that you will enable HTTPS when you deploy your application to production.</p>
<p>If your application is available on the public internet and you feel setting up your own TLS certificate is too bothersome, you can use a free <a class="reference external" href="https://www.cloudflare.com/">Cloudflare</a> account and they will provide you one for <em>free</em>.  There is simply no reason anymore to not enable TLS for all logged in user sessions. (Stormpath has no incentive to recommend Cloudflare. Free TLS for everyone is just too good to pass up).</p>
</div>
<div class="section" id="uri">
<h2><a class="toc-backref" href="#id13">URI</a><a class="headerlink" href="#uri" title="Permalink to this headline">¶</a></h2>
<p>Users can login by visiting <code class="docutils literal"><span class="pre">/login</span></code></p>
<p>If you want to change this path, set the <code class="docutils literal"><span class="pre">stormpath.web.login.uri</span></code> configuration property:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># The context-relative path to the login view:</span>
<span class="na">stormpath.web.login.uri</span> <span class="o">=</span> <span class="s">/login</span>
</pre></div>
</div>
<div class="section" id="next-query-parameter">
<h3><a class="toc-backref" href="#id14">Next Query Parameter</a><a class="headerlink" href="#next-query-parameter" title="Permalink to this headline">¶</a></h3>
<p>The login controller supports a <code class="docutils literal"><span class="pre">next</span></code> query parameter.  If present in the request, the value must be a context-relative path to where the user should be redirected after successful login.</p>
<p>If the login URI is visited with a <code class="docutils literal"><span class="pre">next</span></code> query parameter, the user will be redirected to the <code class="docutils literal"><span class="pre">next</span></code> path instead of the default <code class="docutils literal"><span class="pre">nextUri</span></code>.</p>
</div>
</div>
<div class="section" id="next-uri">
<h2><a class="toc-backref" href="#id15">Next URI</a><a class="headerlink" href="#next-uri" title="Permalink to this headline">¶</a></h2>
<p>If the request to the login URI does not have a <code class="docutils literal"><span class="pre">next</span></code> query parameter, a successful login will redirect the user to the web application&#8217;s <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServletRequest.html#getContextPath()">context path</a> (&#8216;home page&#8217;) by default.</p>
<p>If you want the user to visit a different default post-login path, set the <code class="docutils literal"><span class="pre">stormpath.web.login.nextUri</span></code> configuration property:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># The default context-relative path where the user will be redirected after logging in:</span>
<span class="na">stormpath.web.login.nextUri</span> <span class="o">=</span> <span class="s">/</span>
</pre></div>
</div>
<p>If the request to the login URI has a <code class="docutils literal"><span class="pre">next</span></code> query paramter, that parameter value will be used as the context-relative path instead and the <code class="docutils literal"><span class="pre">stormpath.web.login.nextUri</span></code> value will be ignored.</p>
</div>
<div class="section" id="internationalization-i18n">
<h2><a class="toc-backref" href="#id16">Internationalization (i18n)</a><a class="headerlink" href="#internationalization-i18n" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="i18n.html#i18n"><span class="std std-ref">Internationalization (i18n)</span></a> message keys used in the default login view have names prefixed with <code class="docutils literal"><span class="pre">stormpath.web.login.</span></code>:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># ==================================================</span>
<span class="c"># Login Page</span>
<span class="c"># ==================================================</span>
<span class="na">stormpath.web.login.title</span> <span class="o">=</span> <span class="s">Login</span>
<span class="c"># suppress inspection &quot;UnusedProperty&quot;</span>
<span class="na">stormpath.web.login.status.verified</span> <span class="o">=</span> <span class="s">You have successfully verified your account. You may now login.</span>
<span class="c"># suppress inspection &quot;UnusedProperty&quot;</span>
<span class="na">stormpath.web.login.status.forgot</span> <span class="o">=</span> <span class="s">If you entered a valid account email address, you will receive an email shortly. Please check your email inbox to continue.</span>
<span class="na">stormpath.web.login.status.logout</span> <span class="o">=</span> <span class="s">You have successfully logged out.</span>
<span class="na">stormpath.web.login.status.changed</span> <span class="o">=</span> <span class="s">You have successfully changed your password. You may now login.</span>
<span class="na">stormpath.web.login.status.authcReqd</span> <span class="o">=</span> <span class="s">Please login to continue.</span>
<span class="na">stormpath.web.login.form.title</span> <span class="o">=</span> <span class="s">Login</span>
<span class="na">stormpath.web.login.form.titleWithRegister</span> <span class="o">=</span> <span class="s">Login or {0}</span>
<span class="na">stormpath.web.login.form.registerLink.text</span> <span class="o">=</span> <span class="s">Create Account</span>
<span class="na">stormpath.web.login.form.button.value</span> <span class="o">=</span> <span class="s">Login</span>
<span class="na">stormpath.web.login.form.resetLink.text</span> <span class="o">=</span> <span class="s">Forgot Password?</span>
<span class="na">stormpath.web.login.form.verifyEmail.text</span> <span class="o">=</span> <span class="s">Resend Verification Email?</span>

<span class="na">stormpath.web.login.form.fields.login.label</span> <span class="o">=</span> <span class="s">Username or Email</span>
<span class="na">stormpath.web.login.form.fields.login.placeholder</span> <span class="o">=</span> <span class="s">Username or Email</span>
<span class="na">stormpath.web.login.form.fields.login.required</span> <span class="o">=</span> <span class="s">Username or Email is required.</span>
<span class="na">stormpath.web.login.form.fields.password.label</span> <span class="o">=</span> <span class="s">Password</span>
<span class="na">stormpath.web.login.form.fields.password.placeholder</span> <span class="o">=</span> <span class="s">Password</span>
<span class="na">stormpath.web.login.form.fields.password.required</span> <span class="o">=</span> <span class="s">Password is required.</span>
<span class="na">stormpath.web.login.form.errors.invalidLogin</span> <span class="o">=</span> <span class="s">Invalid username or password.</span>

<span class="na">stormpath.web.login.form.status.unverified</span> <span class="o">=</span> <span class="s">Your account verification email has been sent! Before you can log into your account, you need to activate your account by clicking the link we sent to your inbox.</span>
<span class="na">stormpath.web.login.form.status.verified</span> <span class="o">=</span> <span class="s">Your Account Has Been Verified. You may now login.</span>
<span class="na">stormpath.web.login.form.status.created</span> <span class="o">=</span> <span class="s">Your Account Has Been Created. You may now login.</span>
<span class="na">stormpath.web.login.form.status.forgot</span> <span class="o">=</span> <span class="s">Password Reset Requested. If an account exists for the email provided, you will receive an email shortly.</span>
<span class="na">stormpath.web.login.form.status.reset</span> <span class="o">=</span> <span class="s">Password Reset Successfully. You can now login with your new password.</span>
</pre></div>
</div>
<p>For more information on customizing i18n messages and adding bundle files, please see <a class="reference internal" href="i18n.html#i18n"><span class="std std-ref">Internationalization (i18n)</span></a>.</p>
</div>
<div class="section" id="pre-login-handler">
<span id="login-pre-login-handler"></span><h2><a class="toc-backref" href="#id17">Pre Login Handler</a><a class="headerlink" href="#pre-login-handler" title="Permalink to this headline">¶</a></h2>
<p>Want to validate or modify the form data before it’s handled by us? Then this is the handler that you want to use!</p>
<p>To use a pre login handler, you need to define a class that implements <code class="docutils literal"><span class="pre">WebHandler</span></code> and reference it in your
<code class="docutils literal"><span class="pre">stormpath.properties</span></code> file.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.stormpath.sdk.examples.servlet</span><span class="o">;</span>

<span class="o">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PreLoginHandler</span> <span class="kd">implements</span> <span class="n">WebHandler</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">PreLoginHandler</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Override</span>
<span class="hll">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Account</span> <span class="n">account</span><span class="o">)</span> <span class="o">{</span>
</span>        <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;----&gt; PreLoginHandler&quot;</span><span class="o">);</span>
<span class="hll">        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span>    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">stormpath.properties</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.login.preHandler</span><span class="o">=</span><span class="s">com.stormpath.sdk.examples.servlet.PreLoginHandler</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal"><span class="pre">handle</span></code> method of the <code class="docutils literal"><span class="pre">loginPreHandler</span></code> is entered after the user has entered their email and password, but
before they have been authenticated. This affords the opportunity to validate the information that&#8217;s been entered and
(potentially) take alternative action than the default.</p>
<p>If you return <code class="docutils literal"><span class="pre">false</span></code> then the Java SDK will not continue the authentication flow. This gives you the chance to take
care of that yourself. If you are only manipulating or reading data before it is sent to the backend but you still want
the regular authentication flow to continue then you need to return <code class="docutils literal"><span class="pre">true</span></code>.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">It is invalid to both send the user to an alternate endpoint using <code class="docutils literal"><span class="pre">response.sendRedirect(&quot;&lt;path&gt;&quot;)</span></code> or
forward using <code class="docutils literal"><span class="pre">request.getRequestDispatcher(&quot;&lt;path&gt;&quot;).forward(request,</span> <span class="pre">response);</span></code> AND
return <code class="docutils literal"><span class="pre">true</span></code> from the handler. You will get an <code class="docutils literal"><span class="pre">IllegalStateException</span></code> as the response will have already been
committed because you returned <code class="docutils literal"><span class="pre">true</span></code>.</p>
</div>
</div>
<div class="section" id="post-login-handler">
<span id="login-post-login-handler"></span><h2><a class="toc-backref" href="#id18">Post Login Handler</a><a class="headerlink" href="#post-login-handler" title="Permalink to this headline">¶</a></h2>
<p>Want to run some custom code after a user logs into your site? By defining a <code class="docutils literal"><span class="pre">loginPostHandler</span></code> you’re able achieve tasks like:</p>
<ul class="simple">
<li>Funnel users into a multi-factor authentication workflow.</li>
<li>Refresh a user’s third-party services.</li>
<li>Calculate the last login time of a user.</li>
<li>Prompt a user to complete their profile, or setup billing.</li>
<li>etc.</li>
</ul>
<p>To use a post login handler, you need to define a class that implements <code class="docutils literal"><span class="pre">WebHandler</span></code> and reference it in your
<code class="docutils literal"><span class="pre">stormpath.properties</span></code> file.</p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.stormpath.sdk.examples.servlet</span><span class="o">;</span>

<span class="o">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostLoginHandler</span> <span class="kd">implements</span> <span class="n">WebHandler</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">PostLoginHandler</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Override</span>
<span class="hll">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">handle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Account</span> <span class="n">account</span><span class="o">)</span> <span class="o">{</span>
</span>        <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;----&gt; PostLoginHandler&quot;</span><span class="o">);</span>
<span class="hll">        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span>    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">stormpath.properties</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.login.postHandler</span><span class="o">=</span><span class="s">com.stormpath.sdk.examples.servlet.PostLoginHandler</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal"><span class="pre">handle</span></code> method of the <code class="docutils literal"><span class="pre">loginPostHandler</span></code> is entered after the user has been authenticated.</p>
<p>If the <code class="docutils literal"><span class="pre">handle</span></code> method returns <code class="docutils literal"><span class="pre">true</span></code>, processing will proceed as normal.</p>
<p>As a general rule of thumb, if the handler returns <code class="docutils literal"><span class="pre">true</span></code>, then you would <strong>not</strong> redirect the user to an alternate endpoint.
If the handler returns <code class="docutils literal"><span class="pre">false</span></code>, then you would redirect to an alternate endpoint. If you didn&#8217;t redirect, the original request
would terminate without a response.</p>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">It is invalid to both send the user to an alternate endpoint using <code class="docutils literal"><span class="pre">response.sendRedirect(&quot;&lt;path&gt;&quot;)</span></code> or
forward using <code class="docutils literal"><span class="pre">request.getRequestDispatcher(&quot;&lt;path&gt;&quot;).forward(request,</span> <span class="pre">response);</span></code> AND
return <code class="docutils literal"><span class="pre">true</span></code> from the handler. You will get an <code class="docutils literal"><span class="pre">IllegalStateException</span></code> as the response will have already been
committed because you returned <code class="docutils literal"><span class="pre">true</span></code>.</p>
</div>
</div>
<div class="section" id="events">
<span id="login-events"></span><h2><a class="toc-backref" href="#id19">Events</a><a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h2>
<p>If you implement a <a class="reference internal" href="events.html#events"><span class="std std-ref">Request Event Listener</span></a>, you can listen for login-related events in your application code and execute custom logic if desired.</p>
<p>There are two events that can be triggered during login attempts:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SuccessfulAuthenticationRequestEvent</span></code>: published after a successful login attempt</li>
<li><code class="docutils literal"><span class="pre">FailedAuthenticationRequestEvent</span></code>: published after a failed login attempt</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These authentication events are published during login attempts to the login view, but <em>also</em> during REST requests that might be serviced by your application.</p>
<p>Because most REST architectures are stateless, typically every REST HTTP reuqest must be individually authenticated.  Each authenticated (or failed authentication) REST request, then, will result in publishing one of these two <code class="docutils literal"><span class="pre">AuthenticationRequestEvents</span></code>.</p>
<p class="last">You can determine which type of authentication occurred (login form post, REST API call, etc) by inspecting the event&#8217;s <code class="docutils literal"><span class="pre">AuthenticationResult</span></code> object (<code class="docutils literal"><span class="pre">event.getAuthenticationResult()</span></code>).  You can use an <code class="docutils literal"><span class="pre">AuthenticationResultVisitor</span></code> to determine which type of AuthenticationResult occurred: <code class="docutils literal"><span class="pre">event.getAuthenticationResult().accept(authenticationResultVisitor);</span></code></p>
</div>
</div>
<div class="section" id="authentication-state">
<span id="login-authentication-state"></span><h2><a class="toc-backref" href="#id20">Authentication State</a><a class="headerlink" href="#authentication-state" title="Permalink to this headline">¶</a></h2>
<p>When a user authenticates successfully during a request, how does your application know who the authenticated user is during future requests?</p>
<p>HTTP is a stateless protocol, so there must be a way to represent the <em>state</em> of an authenticated user - the user identity, when they authenticated, etc - across requests.</p>
<p>The Stormpath Java Servlet Plugin supports retaining authentication state across requests by delegating to an <code class="docutils literal"><span class="pre">AuthenticationResult</span></code> <code class="docutils literal"><span class="pre">Saver</span></code>.  Upon a successful authentication, the SDK generates an <code class="docutils literal"><span class="pre">AuthenticationResult</span></code>.  This <code class="docutils literal"><span class="pre">AuthenticationResult</span></code> is relayed to one or more <code class="docutils literal"><span class="pre">Saver</span></code> instances to persist this state however might be necessary so it is available during future requests.</p>
<p>By default, a Cookie-based <code class="docutils literal"><span class="pre">Saver</span></code> is enabled.  This is a nice default because it it ensures that all state is maintained by the HTTP client (&#8216;user agent&#8217;) and sent on all future requests automatically.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The default HTTP Cookie-based <code class="docutils literal"><span class="pre">Saver</span></code> ensures that server side state storage - like a session - is not required at all.  This is beneficial to server-side applications that wish to remain stateless to achieve better performance, scalability, and fault tolerance.</p>
</div>
<p>Even though the cookie approach is the default, you can implement your own <code class="docutils literal"><span class="pre">Saver</span></code> implementation to do whatever you like.</p>
<div class="section" id="saving-authentication-state">
<h3><a class="toc-backref" href="#id21">Saving Authentication State</a><a class="headerlink" href="#saving-authentication-state" title="Permalink to this headline">¶</a></h3>
<p>The Stormpath Java Servlet Plugin will automatically save authentication state for access during later requests for you.  By default, a Cookie-based saver is enabled and no <code class="docutils literal"><span class="pre">HttpSession</span></code> access is used.  You can provide your own implementations entirely if the cookie option is not suitable.</p>
<p>You can enable any number of AuthenticationResult savers as a comma-delimited list by setting the <code class="docutils literal"><span class="pre">stormpath.web.authc.savers</span></code> configuration property.  For example, the default value is the following:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># Default to &#39;cookie&#39; for server statelessness:</span>
<span class="na">stormpath.web.authc.savers</span> <span class="o">=</span> <span class="s">cookie</span>
</pre></div>
</div>
<p>The value can be a comma delimited list of names.</p>
<p>This property reflects a convention: each name in the list corresponds to another configuration property that specifies the <code class="docutils literal"><span class="pre">Saver</span></code> implementation to use.  Each named saver will be invoked after a successful authentication to allow it to persist state as desired.</p>
<p>You specify saver implementations based on the following convention:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers.SAVER_NAME</span> <span class="o">=</span> <span class="s">SAVER_FULLY_QUALIFIED_CLASS_NAME</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SAVER_NAME</span></code> is a simple string name that represents the <code class="docutils literal"><span class="pre">Saver</span></code> implementation.</li>
<li><code class="docutils literal"><span class="pre">SAVER_FULLY_QUALIFIED_CLASS_NAME</span></code> is the fully qualified class name of a class that implements the <code class="docutils literal"><span class="pre">com.stormpath.sdk.servlet.http.Saver</span></code> interface.</li>
</ul>
<p>For example, one saver implementation is pre-configured by default:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers.cookie</span> <span class="o">=</span> <span class="s">com.stormpath.sdk.servlet.filter.account.config.CookieAuthenticationResultSaverFactory</span>
</pre></div>
</div>
<p>So if we look at the default configuration value again:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers</span> <span class="o">=</span> <span class="s">cookie</span>
</pre></div>
</div>
<p>we can see that only the Cookie-based <code class="docutils literal"><span class="pre">Saver</span></code> implementation is to be used to ensure server statelessness out of the box.</p>
<p>If you wanted to enable both cookie and your own name that corresponds to a property that reflects a custom implementation (&#8216;session&#8217; for example):</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers</span> <span class="o">=</span> <span class="s">cookie, session</span>
</pre></div>
</div>
</div>
<div class="section" id="cookie-storage">
<h3><a class="toc-backref" href="#id22">Cookie Storage</a><a class="headerlink" href="#cookie-storage" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">CookieAuthenticationResultSaver</span></code> is the default enabled saver for storing authentication state across requests.</p>
<p>Authentication state is represented as a compact <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-40">cryptographically-signed JSON Web Token</a> (JWT), stored as the cookie value.  This ensures that the user identity, login timestamp, etc. is stored in an efficient standards-compliant - and most importantly - immutable manner.</p>
<p>Additionally, the JWT is cryptographically signed by a key known only to your application (by default, your Stormpath API Key Secret).  This means it is sufficiently impossible for anything outside of your web application (like a browser or javascript client) to tamper with the token and misrepresent information or &#8216;fake&#8217; a login.  As long as HTTPS is enabled <a class="reference internal" href="#https-required"><span class="std std-ref">during login and for the duration of user interaction</span></a>, you can be reasonably assured that the user identity associated with the request is accurate and set only by your application.</p>
<div class="section" id="cookie-config">
<h4>Cookie Config<a class="headerlink" href="#cookie-config" title="Permalink to this headline">¶</a></h4>
<p>You can control the authentication cookie behavior by setting various <code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.*</span></code> configuration properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="22%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html">Cookie</a> property</th>
<th class="head">Config Property Name</th>
<th class="head">Default Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#getName()">name</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.name</span></code></td>
<td><code class="docutils literal"><span class="pre">access_token</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setDomain(java.lang.String)">domain</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.domain</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setPath(java.lang.String)">path</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.path</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code> (assumes web app context path)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setHttpOnly(boolean)">httpOnly</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.httpOnly</span></code></td>
<td><code class="docutils literal"><span class="pre">true</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setSecure-boolean-">secure</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.secure</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setMaxAge-int-">maxAge</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.maxAge</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code> (seconds)</td>
</tr>
</tbody>
</table>
<p>You need to set the refresh token behavior by setting various <code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.*</span></code> configuration properties:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="22%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html">Cookie</a> property</th>
<th class="head">Config Property Name</th>
<th class="head">Default Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#getName()">name</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.name</span></code></td>
<td><code class="docutils literal"><span class="pre">refresh_token</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setDomain(java.lang.String)">domain</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.domain</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setPath(java.lang.String)">path</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.path</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code> (assumes web app context path)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setHttpOnly(boolean)">httpOnly</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.httpOnly</span></code></td>
<td><code class="docutils literal"><span class="pre">true</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setSecure-boolean-">secure</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.secure</span></code></td>
<td><code class="docutils literal"><span class="pre">null</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/Cookie.html#setMaxAge-int-">maxAge</a></td>
<td><code class="docutils literal"><span class="pre">stormpath.web.refreshTokenCookie.maxAge</span></code></td>
<td><code class="docutils literal"><span class="pre">0</span></code> (seconds)</td>
</tr>
</tbody>
</table>
<p>Some notes about the default values:</p>
<div class="sidebar">
<p class="first sidebar-title">Secure Cookies</p>
<p class="last">A <code class="docutils literal"><span class="pre">secure</span></code> cookie will only be sent by the browser over HTTPS connections, otherwise the cookie will not be sent at all.  To eliminate certain security attack vectors, it is important that identity cookies always be <code class="docutils literal"><span class="pre">secure</span></code> in production.</p>
</div>
<ul>
<li><p class="first">The <code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.secure</span></code> property that controls whether the cookie must be secure or not is a little special.  It does not reflect a direct value.  Instead, it reflects an object that returns a <code class="docutils literal"><span class="pre">Resolver&lt;Boolean&gt;</span></code> implementation.  This <code class="docutils literal"><span class="pre">Resolver&lt;Boolean&gt;</span></code> implementation returns <code class="docutils literal"><span class="pre">true</span></code> or <code class="docutils literal"><span class="pre">false</span></code> as to whether the cookie should be secure or not.</p>
<p>Because of the security requirements around identity cookies, the default implementation always requires HTTPS <em>except</em> when it has been determined that the request is sent and received by <code class="docutils literal"><span class="pre">localhost</span></code>.  This allows you to develop on your local machine without requiring a TLS/SSL certificate, but will require one when you deploy to production due to the security attack vectors that would occur otherwise.</p>
<p>If you want to provide your own condition implementation that returns <code class="docutils literal"><span class="pre">true</span></code> or <code class="docutils literal"><span class="pre">false</span></code> based on request criteria, you can specify your own <code class="docutils literal"><span class="pre">com.stormpath.sdk.servlet.http.Resolver&lt;Boolean&gt;</span></code> implementation - for example:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.account.cookie.secure.resolver</span> <span class="o">=</span> <span class="s">my.impl.class.that.implements.ResolverThatReturnsBoolean</span>
</pre></div>
</div>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">stormpath.web.accessTokenCookie.maxAge</span></code> property is set to <code class="docutils literal"><span class="pre">0</span></code> seconds by default. This default value indicates that the expiration of the cookie is set based on the expiration set for the <code class="docutils literal"><span class="pre">OAuth</span> <span class="pre">Policy</span></code>. If set to any other value (including -1), that value will take precedence over the expiration set for the <code class="docutils literal"><span class="pre">OAuth</span> <span class="pre">Policy</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="jwt-creation">
<h4>JWT Creation<a class="headerlink" href="#jwt-creation" title="Permalink to this headline">¶</a></h4>
<p>As mentioned above, the cookie value is actually a <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-40">cryptographically-signed JSON Web Token</a>.  The JWT string itself is created by the <code class="docutils literal"><span class="pre">stormpathAuthenticationJwtFactory</span></code> bean, an instance of the <code class="docutils literal"><span class="pre">AuthenticationJwtFactory</span></code> interface.</p>
<p>The default implementation supports configuring the JWT&#8217;s TTL (time-to-live) to indicate how long it is valid for.  By default, the JWT itself is valid for 3 days, but it would never be used longer than the cookie&#8217;s <code class="docutils literal"><span class="pre">maxAge</span></code> value (1 day by default).  If you need to change the JWT TTL, it is configurable via the <code class="docutils literal"><span class="pre">stormpath.web.account.jwt.ttl</span></code> property:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># value is in _seconds_ (not milliseconds):</span>
<span class="na">stormpath.web.account.jwt.ttl</span> <span class="o">=</span> <span class="s">259200</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When a JWT is stored in a cookie, the JWT TTL <em>must</em> be greater than or equal to the cookie&#8217;s <code class="docutils literal"><span class="pre">maxAge</span></code> value (in seconds), otherwise the cookie will retain a stale/unusable JWT.</p>
</div>
</div>
<div class="section" id="disabling-cookie-storage">
<h4>Disabling Cookie Storage<a class="headerlink" href="#disabling-cookie-storage" title="Permalink to this headline">¶</a></h4>
<p>If you are going to use your own <code class="docutils literal"><span class="pre">Saver&lt;AuthenticationResult&gt;</span></code> implementation, you can disable the cookie if desired:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers.cookie.enabled</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
<p>But be careful: if you disable this, you <em>must</em> enable at least one other saver - at least one must be available to handle authentication correctly.</p>
</div>
</div>
<div class="section" id="custom-savers">
<h3><a class="toc-backref" href="#id23">Custom Savers</a><a class="headerlink" href="#custom-savers" title="Permalink to this headline">¶</a></h3>
<p>Finally, if the default Cookie-based <code class="docutils literal"><span class="pre">Saver</span></code> implementation is not sufficient. For example, you want an HttpSession-based <code class="docutils literal"><span class="pre">Saver</span></code>, then you can create the  <code class="docutils literal"><span class="pre">stormpath.web.authc.savers.session</span></code> configuration property.  The value must be the full qualified class name of an implementation of the <code class="docutils literal"><span class="pre">com.stormpath.sdk.servlet.http.Saver</span></code> interface.  For example:</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">stormpath.web.authc.savers.session</span> <span class="o">=</span> <span class="s">com.my.httpsession.based.Saver</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="social.html" class="btn btn-neutral float-right" title="Social Login" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="registration.html" class="btn btn-neutral" title="Registration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Stormpath, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  

</body>
</html>