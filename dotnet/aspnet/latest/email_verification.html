

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Email verification &mdash; ASP.NET Library Guide  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="ASP.NET Library Guide  documentation" href="index.html"/>
        <link rel="next" title="Troubleshooting" href="troubleshooting.html"/>
        <link rel="prev" title="Password reset" href="password_reset.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  
  <script src="https://cdn.optimizely.com/js/225847041.js"></script>

  
  <script>
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '986262161469311');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=986262161469311&ev=PageView&noscript=1"
  /></noscript>

  <style type="text/css">
    #migration-banner {
      background-image:url(https://stormpath.com/wp-content/uploads/2017/03/stormpath-blog-background.png);
      background-repeat: no-repeat;
      background-size: 100%;
      color: #fff;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      font-weight: 300;
      max-width: none;
      padding: 35px 20px 0 20px;
      text-align: center;
    }
    @media screen and (min-width: 1400px) {
      #migration-banner {
        max-width: 800px;
      }
    }
    #migration-banner a{
      color: #fff;
      text-decoration: underline;
    }
    #migration-banner img {
      border: none;
    }
    #migration-banner p {
      padding: 20px 0;
    }
  </style>
</head>

<body class="wy-body-for-nav" role="document">

  
  <noscript><iframe src=".//www.googletagmanager.com/ns.html?id=GTM-NQZZFW"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NQZZFW');</script>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ASP.NET Library Guide
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
  
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#what-does-this-library-do">What does this library do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#who-should-use-stormpath">Who should use Stormpath</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#create-a-stormpath-account">Create a Stormpath account</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#create-an-api-key-pair">Create an API Key pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#find-your-stormpath-application">Find your Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#example-projects">Example projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#create-a-new-project">Create a new project</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#install-the-library">Install the library</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#initialize-the-middleware">Initialize the middleware</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#loading-order">Loading order</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#stormpath-directory">.stormpath directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#application-base-directory">Application base directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#required-settings">Required settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#api-credentials-file">API credentials file</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#markup-file-yaml-or-json">Markup file (YAML or JSON)</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#environment-variables">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#inline-options">Inline options</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#default-features">Default features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#disabling-features">Disabling features</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#disabling-content-types">Disabling content types</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#specifying-the-server-uri">Specifying the server URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#specifying-the-stormpath-base-url">Specifying the Stormpath base URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#stormpath-client-options">Stormpath Client options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request_context.html">Request context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request_context.html#stormpath-client">Stormpath Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="request_context.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request_context.html#current-account">Current Account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="request_context.html#claimsidentity">ClaimsIdentity</a></li>
<li class="toctree-l3"><a class="reference internal" href="request_context.html#stormpath-iaccount">Stormpath IAccount</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using_the_sdk.html">Using the Stormpath SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using_the_sdk.html#tasks-and-cancellation">Tasks and Cancellation</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_the_sdk.html#making-synchronous-calls">Making synchronous calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_the_sdk.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="using_the_sdk.html#search-for-an-account-by-email-address">Search for an account by email address</a></li>
<li class="toctree-l3"><a class="reference internal" href="using_the_sdk.html#update-a-user-s-password">Update a user&#8217;s password</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cors.html">Cross-origin requests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cors.html#configuring-the-pipeline">Configuring the pipeline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#cookie-authentication">Cookie authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#setting-token-expiration-time">Setting token expiration time</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#configuring-cookie-flags">Configuring cookie flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#token-validation-strategy">Token validation strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#oauth-2-0-password-grant">OAuth 2.0 password grant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="authentication.html#getting-a-new-access-token">Getting a new access token</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_authentication.html">API authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_authentication.html#issuing-api-keys">Issuing API keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_authentication.html#http-basic-authentication">HTTP Basic authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_authentication.html#oauth-2-0-client-credentials-grant">OAuth 2.0 client credentials grant</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authorization.html#requiring-login">Requiring login</a></li>
<li class="toctree-l2"><a class="reference internal" href="authorization.html#groups-and-roles">Groups and roles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="authorization.html#requiring-a-group">Requiring a Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="authorization.html#requiring-multiple-groups">Requiring multiple Groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="authorization.html#fine-grained-permissions">Fine-grained permissions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="id_site.html">ID Site</a><ul>
<li class="toctree-l2"><a class="reference internal" href="id_site.html#who-should-use-id-site">Who should use ID Site?</a></li>
<li class="toctree-l2"><a class="reference internal" href="id_site.html#how-does-it-work">How does it work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="id_site.html#enabling-id-site">Enabling ID Site</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">View templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="templates.html#default-views">Default views</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html#custom-views">Custom views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="templates.html#view-models">View models</a></li>
<li class="toctree-l3"><a class="reference internal" href="templates.html#state-token">State token</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="oauth2.html">OAuth 2.0 API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="oauth2.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="oauth2.html#client-credentials-grant-options">Client credentials grant options</a></li>
<li class="toctree-l3"><a class="reference internal" href="oauth2.html#password-grant-options">Password grant options</a></li>
<li class="toctree-l3"><a class="reference internal" href="oauth2.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="oauth2.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="me_api.html">Current user API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="me_api.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="me_api.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="me_api.html#using-the-endpoint">Using the endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="me_api.html#link-expansion">Link expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="me_api.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#password-strength-requirements">Password strength requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#auto-login">Auto login</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#pre-registration-handler">Pre-registration handler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#targeting-an-account-store">Targeting an Account Store</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#post-registration-handler">Post-registration handler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#saving-custom-data-for-new-accounts">Saving Custom Data for new Accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#addding-new-accounts-to-groups">Addding new Accounts to groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#customizing-the-form">Customizing the form</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#making-fields-optional">Making fields optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#adding-custom-fields">Adding custom fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#changing-field-order">Changing field order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#mobile-json-api">Mobile/JSON API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="registration.html#getting-the-form-view-model">Getting the form view model</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#registering-a-user">Registering a user</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration.html#supplying-custom-fields">Supplying custom fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#pre-login-handler">Pre-login handler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#targeting-an-account-store">Targeting an Account Store</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="login.html#post-login-handler">Post-login handler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#modifying-custom-data-on-login">Modifying Custom Data on login</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="login.html#customizing-the-form">Customizing the form</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#mobile-json-api">Mobile/JSON API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="login.html#making-a-login-attempt">Making a login attempt</a></li>
<li class="toctree-l3"><a class="reference internal" href="login.html#getting-the-form-view-model">Getting the form view model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="login.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="social_login.html">Social login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#setting-up-facebook-login">Setting up Facebook login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-application">Create a Facebook application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#specify-allowed-urls">Specify allowed URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-facebook-directory">Create a Facebook Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#map-the-directory">Map the Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-facebook-login">Test Facebook login</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#setting-up-github-login">Setting up Github login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-github-application">Create a Github application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-github-directory">Create a Github Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id2">Map the Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#configure-your-server-uri">Configure your server URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-github-login">Test Github login</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#setting-up-google-login">Setting up Google login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-project">Create a Google project</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-google-login">Enable Google login</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-oauth-credentials">Create OAuth credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-google-directory">Create a Google Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id3">Map the Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id4">Configure your server URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-google-login">Test Google login</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="social_login.html#setting-up-linkedin-login">Setting up LinkedIn login</a><ul>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-application">Create a LinkedIn application</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#enable-linkedin-permissions">Enable LinkedIn permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#create-a-linkedin-directory">Create a LinkedIn Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#id5">Map the Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#configuring-your-server-uri">Configuring Your Server URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="social_login.html#test-linkedin-login">Test LinkedIn login</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="logout.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#pre-logout-handler">Pre-logout handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#post-logout-handler">Post-logout handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="password_reset.html">Password reset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#enabling-the-workflow">Enabling the workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="password_reset.html#forgot-route">Forgot Route</a></li>
<li class="toctree-l3"><a class="reference internal" href="password_reset.html#change-route">Change Route</a></li>
<li class="toctree-l3"><a class="reference internal" href="password_reset.html#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#auto-login">Auto login</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#pre-reset-handler">Pre-reset handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#post-reset-handler">Post-reset handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#mobile-json-api">Mobile/JSON API</a></li>
<li class="toctree-l2"><a class="reference internal" href="password_reset.html#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Email verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#enabling-the-workflow">Enabling the workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-options">Configuration options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-example">Configuration example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#auto-login">Auto login</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-verify-handler">Pre-verify handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#post-verify-handler">Post-verify handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mobile-json-api">Mobile/JSON API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#verifying-a-user">Verifying a User</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requesting-a-new-link">Requesting a new link</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#default-configuration">Default configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#inspecting-traffic">Inspecting traffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#getting-help">Getting help</a></li>
</ul>
</li>
</ul>

            
          

  <hr/>

  <li class="toctree-l1">
    <a class="reference internal" href="./csharp/product-guide/latest">C# SDK Documentation &rarr;</a>
  </li>

  <li class="toctree-l1">
    <a class="reference internal" href="./vbnet/product-guide/latest">VB SDK Documentation &rarr;</a>
  </li>

  <li class="toctree-l1">
    <a class="reference internal" href="./dotnet/api/">SDK API Reference &rarr;</a>
  </li>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASP.NET Library Guide</a>
        
      </nav>


      

      <div id="migration-banner" class="wy-nav-content">
        <div id="banner">
          <img src="https://stormpath.com/wp-content/uploads/2017/03/stormpath-hero-logos-2.png" alt="" width="512">
          <p>
            The Stormpath API will shut down on 8/17/2017 at noon PST. Learn more in our <a href="https://stormpath.com/oktaplusstormpath">Migration FAQ</a>.
          </p>
        </div>
      </div>

      <div class="wy-nav-content">
        <div class="rst-content">
          

 







<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Email verification</li>
    <li class="wy-breadcrumbs-aside">
      
          
          <a href="_sources/email_verification.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="email-verification">
<span id="id1"></span><h1>Email verification<a class="headerlink" href="#email-verification" title="Permalink to this headline">¶</a></h1>
<p>Stormpath provides a self-service email verification flow for new accounts, where users will need to verify their email address before their account is enabled. This library adds this functionality to your ASP.NET application automatically if it is enabled in your Stormpath Directory.</p>
<p>By default, this library will serve an Email Verification form and callback handler at <code class="docutils literal"><span class="pre">/verify</span></code>, <em>if</em> the Verification Email workflow is enabled in Stormpath. You can change these URIs, or disable the feature entirely if you wish (see <a class="reference internal" href="#email-verification-configuration"><span>Configuration options</span></a>).</p>
<div class="section" id="enabling-the-workflow">
<h2>Enabling the workflow<a class="headerlink" href="#enabling-the-workflow" title="Permalink to this headline">¶</a></h2>
<p>To enable email verification, you need to configure the Stormpath Directory your application is using. Follow these steps:</p>
<ol class="arabic simple">
<li>Use the <a class="reference external" href="https://api.stormpath.com">Stormpath Admin Console</a> to find the Stormpath Directory linked to your Application.</li>
<li>Navigate to the Workflows section and enable the <strong>Verification Email</strong> workflow.</li>
<li>Modify the <strong>Link Base URL</strong> to point to your application:</li>
</ol>
<div class="highlight-sh"><div class="highlight"><pre><span></span>http://yourapplication.com/verify
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">/verify</span></code> route is automatically provided by this library. If you want to change the route URI, see <a class="reference internal" href="#email-verification-configuration"><span>Configuration options</span></a>.</p>
</div>
</div>
<div class="section" id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>After enabling the workflow in Stormpath, restart your ASP.NET application. The behavior of the <code class="docutils literal"><span class="pre">/register</span></code> route will change:</p>
<ul class="simple">
<li>New accounts will initially be in an <strong>unverified</strong> state, and the user will receive an email with a link.</li>
<li>Clicking that link will take the user to <code class="docutils literal"><span class="pre">/verify</span></code>, which will automatically use the token provided in the email to verify their account.</li>
<li>The user can now log in as usual.</li>
<li>Additionally, visiting <code class="docutils literal"><span class="pre">/verify</span></code> directly will allow the user to request a new link.</li>
</ul>
</div>
<div class="section" id="configuration-options">
<span id="email-verification-configuration"></span><h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>This feature supports several options that you can configure using code or markup (see the <a class="reference internal" href="configuration.html#configuration"><span>Configuration</span></a> section):</p>
<ul class="simple">
<li><strong>enabled</strong>: Whether the feature is enabled. (Default: <code class="docutils literal"><span class="pre">null</span></code>, see note below)</li>
<li><strong>uri</strong>: The path for this feature. (Default: <code class="docutils literal"><span class="pre">/verify</span></code>)</li>
<li><strong>nextUri</strong>: The location to send the user after verifying their email. (Default: <code class="docutils literal"><span class="pre">/login?status=verified</span></code>, but see <a class="reference internal" href="#email-verification-auto-login"><span>Auto login</span></a>)</li>
<li><strong>view</strong>: The view to render; see <a class="reference internal" href="templates.html#templates"><span>View templates</span></a>. (Default: <code class="docutils literal"><span class="pre">verify</span></code>)</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>enabled</strong> property can be set to <code class="docutils literal"><span class="pre">true</span></code>, <code class="docutils literal"><span class="pre">false</span></code>, or <code class="docutils literal"><span class="pre">null</span></code>. A value of <code class="docutils literal"><span class="pre">null</span></code> means that the route will automatically be enabled if the default Account Store for the current Stormpath application has the Verification Email workflow enabled.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Any unchanged options will retain their default values. See the <a class="reference internal" href="#email-verification-default-configuration"><span>Default configuration</span></a> section to view the defaults.</p>
</div>
<div class="section" id="configuration-example">
<h3>Configuration example<a class="headerlink" href="#configuration-example" title="Permalink to this headline">¶</a></h3>
<p>You could, for example, change the endpoint path by setting this configuration (shown as YAML):</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">verifyEmail</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">uri</span><span class="p p-Indicator">:</span> <span class="s">&quot;/verifyEmail&quot;</span>
</pre></div>
</div>
<p>You could also set this configuration via code:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">UseStormpath</span><span class="p">(</span><span class="k">new</span> <span class="n">StormpathConfiguration</span>
<span class="p">{</span>
    <span class="n">Web</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebConfiguration</span>
    <span class="p">{</span>
        <span class="n">VerifyEmail</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebVerifyEmailRouteConfiguration</span>
        <span class="p">{</span>
            <span class="n">Uri</span> <span class="p">=</span> <span class="s">&quot;/verifyEmail&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="configuration.html#configuration"><span>Configuration</span></a> section for more details on how configuration works, or <a class="reference internal" href="#email-verification-default-configuration"><span>Default configuration</span></a> to see the default values for this route.</p>
</div>
</div>
<div class="section" id="auto-login">
<span id="email-verification-auto-login"></span><h2>Auto login<a class="headerlink" href="#auto-login" title="Permalink to this headline">¶</a></h2>
<p>Our library implements the most secure workflow by default: the user must log in after verifying their account.</p>
<p>By default, the user is redirected to <code class="docutils literal"><span class="pre">/login?status=verified</span></code> (the value of <code class="docutils literal"><span class="pre">verifyEmail.nextUri</span></code>), which renders the login form with a status message indicating that the account has been successfully verified.</p>
<p>If <a class="reference internal" href="registration.html#auto-login"><span>Auto login</span></a> is enabled, the user will be automatically logged in after they reset their password. The user will <strong>not</strong> be redirected to <code class="docutils literal"><span class="pre">verifyEmail.nextUri</span></code>, but instead will be redirected to <code class="docutils literal"><span class="pre">register.nextUri</span></code>.</p>
</div>
<div class="section" id="pre-verify-handler">
<h2>Pre-verify handler<a class="headerlink" href="#pre-verify-handler" title="Permalink to this headline">¶</a></h2>
<p>If you need to run code before a user verifies their email address, you can attach a pre-verify handler when you configure the Stormpath middleware:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">UseStormpath</span><span class="p">(</span><span class="k">new</span> <span class="n">StormpathMiddlewareOptions</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Configuration</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StormpathConfiguration</span><span class="p">(),</span> <span class="c1">// existing config, if any</span>
    <span class="n">PreVerifyEmailHandler</span> <span class="p">=</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});.</span>
</pre></div>
</div>
<p>The signature of the handler is a <code class="docutils literal"><span class="pre">Func</span></code> that accepts a <code class="docutils literal"><span class="pre">PreVerifyEmailContext</span></code> and a <code class="docutils literal"><span class="pre">CancellationToken</span></code>, and returns a <code class="docutils literal"><span class="pre">Task</span></code>. It can be declared as a method instead of with lambda syntax:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="n">Task</span> <span class="nf">MyPreVerifyHandler</span><span class="p">(</span>
    <span class="n">PreVerifyEmailContext</span> <span class="n">context</span><span class="p">,</span>
    <span class="n">CancellationToken</span> <span class="n">ct</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="post-verify-handler">
<h2>Post-verify handler<a class="headerlink" href="#post-verify-handler" title="Permalink to this headline">¶</a></h2>
<p>If you need to run code after user verifies their email address, you can attach a post-verify handler when you configure the Stormpath middleware:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">UseStormpath</span><span class="p">(</span><span class="k">new</span> <span class="n">StormpathMiddlewareOptions</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Configuration</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StormpathConfiguration</span><span class="p">(),</span> <span class="c1">// existing config, if any</span>
    <span class="n">PostVerifyEmailHandler</span> <span class="p">=</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The signature of the handler is a <code class="docutils literal"><span class="pre">Func</span></code> that accepts a <code class="docutils literal"><span class="pre">PostVerifyEmailContext</span></code> and a <code class="docutils literal"><span class="pre">CancellationToken</span></code>, and returns a <code class="docutils literal"><span class="pre">Task</span></code>. It can be declared as a method instead of with lambda syntax:</p>
<div class="highlight-csharp"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="n">Task</span> <span class="nf">MyPostVerifyHandler</span><span class="p">(</span>
    <span class="n">PostVerifyEmailContext</span> <span class="n">context</span><span class="p">,</span>
    <span class="n">CancellationToken</span> <span class="n">ct</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="mobile-json-api">
<h2>Mobile/JSON API<a class="headerlink" href="#mobile-json-api" title="Permalink to this headline">¶</a></h2>
<p>If you are using this library from a mobile application, or a client framework like Angular or React, you&#8217;ll interact with this endpoint via GET and POST requests.</p>
<div class="section" id="verifying-a-user">
<h3>Verifying a User<a class="headerlink" href="#verifying-a-user" title="Permalink to this headline">¶</a></h3>
<p>To verify a user, make a GET request with the <code class="docutils literal"><span class="pre">sptoken</span></code> from the verification email:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>GET /verify?sptoken=&lt;token&gt;
Accept: application/json
</pre></div>
</div>
<p>If validation succeeds, the endpoint will respond with <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code>.</p>
<p>If an error occurs, you&#8217;ll get an error response:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
  <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;sptoken parameter not provided.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="requesting-a-new-link">
<h3>Requesting a new link<a class="headerlink" href="#requesting-a-new-link" title="Permalink to this headline">¶</a></h3>
<p>To request a new link, make a POST request:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>POST /verify
Accept: application/json
Content-Type: application/json

{
  &quot;email&quot;: &quot;foo@bar.com&quot;
}
</pre></div>
</div>
<p>The endpoint will always respond with <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code>, regardless of whether the email address is valid.</p>
</div>
</div>
<div class="section" id="default-configuration">
<span id="email-verification-default-configuration"></span><h2>Default configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h2>
<p>Options that are not overridden by explicit configuration (see <a class="reference internal" href="configuration.html#configuration"><span>Configuration</span></a>) will retain their default values.</p>
<p>For reference, the full default configuration for this route is shown as YAML below:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">verifyEmail</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
    <span class="l l-Scalar l-Scalar-Plain">uri</span><span class="p p-Indicator">:</span> <span class="s">&quot;/verify&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">nextUri</span><span class="p p-Indicator">:</span> <span class="s">&quot;/login?status=verified&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">view</span><span class="p p-Indicator">:</span> <span class="s">&quot;verify&quot;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You can also refer to the <a class="reference external" href="https://github.com/stormpath/stormpath-framework-spec/blob/master/example-config.yaml">Example Stormpath configuration</a> to see the entire default library configuration.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="password_reset.html" class="btn btn-neutral" title="Password reset" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Stormpath, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/scrollspy.js"></script>
      <script type="text/javascript" src="_static/gumshoe.min.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src=".//cdn.optimizely.com/js/225847041.js"></script>


  

</body>
</html>